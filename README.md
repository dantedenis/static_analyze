# Static Analyze

Сервис статического анализа
Обращается к [сервису истории цен](https://github.com/dantedenis/service_history), и забирает информацию о состоянии дел с начала текущего дня и то текущего момента
И далее осуществляет периодический опрос

`К сервису истории обращается с помощью RPC метода, он описан в proto-файле`

Режим работы сервиса можно менять изменяя параметры окружающей среды

Осуществляет расчет OHLC-показателей в разрезе таймфреймов(1мин, 5мин, 15мин, 30мин, 60мин)

Реализованы методы АПИ  
* `GET /health` - возвращает 200, если сервис доступен  
* `GET /parameters` для обращение необходимо тело запроса:  
```json
{
    "currency":"USDRUB", (валютная пара)
    "period": 60        (разрез таймфрейма в мин)
}
```
Ответ (пример):
```json
{
    "last_update": "2022-08-15T11:13:09.72683871Z",
    "currency_pair": "GBPJPY",
    "timeframe": "60 min",
    "indicators": [
        {
            "open": 0.5017,
            "high": 0.9996,
            "low": 0.0008,
            "close": 0.373,
            "period_start": "2022-08-15 00:00:00 +0000 UTC",
            "period_end": "2022-08-15 00:01:00 +0000 UTC"
        },
        {
            "open": 0.4076,
            "high": 0.9982,
            "low": 0.0007,
            "close": 0.0511,
            "period_start": "2022-08-15 00:01:00 +0000 UTC",
            "period_end": "2022-08-15 00:02:00 +0000 UTC"
        },
        ..............
    ]
}
```

Запуск с помощью docker-compose:

* `make create_network` - если не настроен, необходим для взаимодействия сервисов

* `make run` - старт сервиса

* `make restart` - рестарт сервиса

* `make kill` - стоп сервиса и удаление контейнеров

* `make logs` - вывод логов


Запуск тестов:

* `make test `- тесты

* `make coverage` - генерация отчета о покрытии

* `make lint` - проверка линтером
